# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: '3'

tasks:
  rotate-issuing-ca:
    desc: "Reissue the Issuing CA using the Reissuance primitive (same key material)"
    cmds:
      - |
        echo "üîê Rotating Issuing CA in Vault..."
        python3 .taskfiles/vault/rotate_iss_ca.py
    dir: "{{.ROOT_DIR}}"
    env:
      VAULT_ADDR: '{{.VAULT_ADDR}}'
    preconditions:
      - which python3
      - test -f ./.taskfiles/vault/rotate_iss_ca.py
      - vault status
