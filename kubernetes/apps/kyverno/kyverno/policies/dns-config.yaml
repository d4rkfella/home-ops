---
# yaml-language-server: $schema=https://kubernetes-schemas.darkfellanetwork.com/kyverno.io/clusterpolicy_v1.json
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: add-ndots
spec:
  rules:
  - name: add-ndots
    match:
      any:
      - resources:
          kinds:
          - Pod
    mutate:
      patchStrategicMerge:
        spec:
          dnsConfig:
            options:
              - name: ndots
                value: "2"
  - name: add-ndots-2
    match:
      any:
      - resources:
          kinds:
          - Pod
          names:
            - envoy-envoy-gateway-system-*
    mutate:
      patchStrategicMerge:
        spec:
          dnsConfig:
            options:
              - name: ndots
                value: "1"
