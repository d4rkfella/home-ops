location /api {
    access_by_lua_block {
        local file = io.open("/etc/secrets/token", "r")
        if file then
            local token = file:read("*a")
            file:close()
            ngx.req.set_header("Authorization", "Bearer " .. token)
        end
    }
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_pass_request_body on;
    proxy_pass_request_headers on;
    client_max_body_size 5g;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection $connection_upgrade;
    proxy_pass https://prometheus-operated.observability.svc.cluster.local:8082;
}
